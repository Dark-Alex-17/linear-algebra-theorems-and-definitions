\section{The Rational Canonical Form}

\begin{definition}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$ with characteristic polynomial

	\[f(t) = (-1)^n(\phi_1(t))^{n_1}(\phi_2(t))^{n_2} \dots (\phi_k(t))^{n_k},\]

	where the $\phi_i(t)$'s ()$1 \leq i \leq k$) are distinct irreducible monic polynomials and the $n_i$'s are positive integers. For $1 \leq i \leq k$, we define the subset $K_{\phi_i}$ of $V$ by

	\[K_{\phi_i} = \{x \in V : (\phi_i(T))^p(x) = 0\ \text{for some positive integer}\ p\}.\]
\end{definition}

\begin{definition}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, and let $x$ be a nonzero vector in $V$. We use the notation $\mathsf{C}_x$ for the $T$-cyclic subspace generated by $x$. Recall \autoref{Theorem 5.22}, that if $\ldim{\mathsf{C}_x} = k$, then the set

	\[\{x, T(x), T^2(x), \dots, T^{k-1}(x)\}\]

	is an ordered basis for $\mathsf{C}_x$. To distinguish this basis from all other ordered bases for $\mathsf{C}_x$, we call it the $T$-\textbf{cyclic basis generated by \textit{x}} and denote it by $\beta_x$. Let $A$ be the matrix representation of the restriction of $T$ to $\mathsf{C}_x$ relative to the ordered basis $\beta_x$. Recall that

	\[A = \begin{pmatrix}
			0      & 0      & \dots & 0      & -a_0       \\
			1      & 0      & \dots & 0      & -a_1       \\
			0      & 1      & \dots & 0      & -a_2       \\
			\vdots & \vdots &       & \vdots & \vdots     \\
			0      & 0      & \dots & 1      & -a_{k - 1}
		\end{pmatrix}\]

	where

	\[a_0x + a_1T(x) + \dots + a_{k-1}T^{k-1}(x) + T^k(x) = 0.\]

	furthermore, the characteristic polynomial of $A$ is given by

	\[\det(A - tI) = (-1)^k(a_0 + a_1t + \dots + a_{k-1}t^{k-1} + t^k).\]

	The matrix $A$ is called the \textbf{companion matrix} of the monic polynomial $h(t) = a_0 + a_1t + \dots + a_{k-1}t^{k-1} + t^k$. Every monic polynomial has a companion matrix, and the characteristic polynomial of the companion matrix of a monic polynomial $g(t)$ of degree $k$ is equal to $(-1)^kg(T)$. By \autoref{Theorem 7.15}, the monic polynomial $h(t)$ is also the minimal polynomial of $A$. Since $A$ is the matrix representation of the restriction of $T$ to $\mathsf{C}_x$, $h(t)$ is also the minimal polynomial of this restriction. Note that $h(t)$ is also the $T$-annihilator of $x$.

	It is the object of this section to prove that for every linear operator $T$ on a finite-dimensional vector space $V$, there exists an ordered basis $\beta$ for $V$ such that the matrix representation $[T]_\beta$ is of the form

	\[\begin{pmatrix}
			C_1    & O      & \dots & O      \\
			O      & C_2    & \dots & O      \\
			\vdots & \vdots &       & \vdots \\
			O      & O      & \dots & C_r
		\end{pmatrix},\]

	where each $C_i$ is the companion matrix of a polynomial $(\phi(t))^m$ such that $phi(t)$ is a monic irreducible divisor of the characteristic polynomial of $T$ and $m$ is a positive integer. A matrix representation of this kind is called a \textbf{rational canonical form} of $T$. We call the accompanying basis a \textbf{rational canonical basis} for $T$.
\end{definition}

\begin{lemma}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, let $x$ be a nonzero vector in $V$, and suppose that the $T$-annihilator of $x$ is of the form $(\phi(t))^p$ for some irreducible monic polynomial $\phi(t)$. Then $\phi(t)$ divides the minimal polynomial of $T$, and $x \in K_\phi$.
\end{lemma}

\begin{theorem}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, and let $\beta$ be an ordered basis for $V$. Then $\beta$ is a rational canonical basis for $T$ if and only if $\beta$ is the disjoint union of $T$-cyclic bases $\beta_{v_i}$, where each $v_i$ lies in $K_\phi$ for some irreducible monic divisor $\phi(t)$ of the characteristic polynomial of $T$.
\end{theorem}

\begin{theorem}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, and suppose that

	\[p(t) = (\phi_1(t))^{m_1} (\phi_2(t))^{m_2} \dots (\phi_k(t))^{m_k}\]

	is the minimal polynomial of $T$, where the $\phi_i(t)$'s ($1 \leq i \leq k$) are the distinct irreducible monic factors of $p(t)$ and the $m_i$'s are the positive integers. Then the following statements are true.

	\begin{enumerate}
		\item $K_{\phi_i}$ is a nonzero $T$-invariant subspace of $V$ for each $i$.
		\item If $x$ is a nonzero vector in some $K_{\phi_i}$, then the $T$-annihilator of $x$ is of the form $(\phi_i(t))^p$ for some integer $p$.
		\item $K_{\phi_i} \cap K_{\phi_j} = \{0\}$ for $i \neq j$.
		\item $K_{\phi_i}$ is invariant under $\phi_j(T)$ for $i \neq j$, and the restriction of $\phi_j(T)$ to $K_{\phi_i}$ is one-to-one and onto.
		\item $K_{\phi_i} = \n{(\phi_i(T))^{m_i}}$ for each $i$.
	\end{enumerate}
\end{theorem}

\begin{lemma}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, and suppose that

	\[p(t) = (\phi_1(t))^{m_1} (\phi_2(t))^{m_2} \dots (\phi_k(t))^{m_k}\]

	is the minimal polynomial of $T$, where the $\phi_i$'s ($1 \leq i \leq k$) are the distinct irreducible monic factors of $p(t)$ and the $m_i$'s are the positive integers. For $1 \leq i \leq k$, let $v_i \in K_{\phi_i}$ be such that

	\[v_1 + v_2 + \dots + v_k = 0.\]

	Then $v_i = 0$ for all $i$.
\end{lemma}

\begin{theorem}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, and suppose that

	\[p(t) = (\phi_1(t))^{m_1} (\phi_2(t))^{m_2} \dots (\phi_k(t))^{m_k}\]

	is the minimal polynomial of $T$, where the $\phi_i$'s ($1 \leq i \leq k$) are the distinct irreducible monic factors of $p(t)$ and the $m_i$'s are the positive integers. For $1 \leq i \leq k$, let $S_i$ be a linearly independent subset of $K_{\phi_i}$. Then

	\begin{enumerate}
		\item $S_i \cap S_j = \emptyset$ for $i \neq j$.
		\item $S_1 \cup S_2 \cup \dots \cup S_k$ is linearly independent.
	\end{enumerate}
\end{theorem}

\begin{theorem}
	\hfill\\
	Let $v_1, v_2, \dots, v_k$ be distinct vectors in $K_\phi$ such that

	\[S_1 = \beta_{v_1} \cup \beta_{v_2} \cup \dots \cup \beta_{v_k}\]

	is linearly independent. For each $i$, choose $w_i \in V$ such that $\phi(T)(w_i) = v_i$. Then

	\[S_2 = \beta_{w_1} \cup \beta_{w_2} \cup \dots \cup \beta_{w_k}\]

	is also linearly independent.
\end{theorem}

\begin{lemma}
	\hfill\\
	Let $W$ be a $T$-invariant subspace of $K_\phi$, and let $\beta$ be a basis for $W$. Then the following statements are true.

	\begin{enumerate}
		\item Suppose that $x \in \n{\phi(T)}$, but $x \notin W$. Then $\beta \cup \beta_x$ is linearly independent.
		\item For some $w_1, w_2, \dots, w_s$ in $\n{\phi(T)}$, $\beta$ can be extended to the linearly independent set

		      \[\beta' = \beta \cup \beta_{w_1} \cup \beta_{w_2} \cup \dots \cup \beta_{w_s},\]

		      whose span contains $\n{\phi(T)}$.
	\end{enumerate}
\end{lemma}

\begin{theorem}
	\hfill\\
	If the minimal polynomial of $T$ is of the form $p(t) = (\phi(t))^m$, then there exists a rational canonical basis for $T$.
\end{theorem}

\begin{corollary}
	\hfill\\
	$K_\phi$ has a basis consisting of the union of $T$-cyclic bases.
\end{corollary}

\begin{theorem}
	\hfill\\
	Every linear operator on a finite-dimensional vector space has a rational canonical basis and, hence, a rational canonical form.
\end{theorem}

\begin{theorem}
	\hfill\\
	Let $T$ be a linear operator on an $n$-dimensional vector space $V$ with characteristic polynomial

	\[f(t) = (-1)^n(\phi_1(t))^{n_1} (\phi_2(t))^{n_2} \dots (\phi_k(t))^{n_k},\]

	where the $\phi_i(t)$'s ($1 \leq i \leq k$) are distinct irreducible monic polynomials and the $n_i$'s are positive integers. Then the following statements are true.

	\begin{enumerate}
		\item $\phi_1(t), \phi_2(t), \dots, \phi_k(t)$ are the irreducible monic factors of the minimal polynomial.
		\item For each $i$, $\ldim{K_{\phi_i}} = d_in_i$, where $d_i$ is the degree of $\phi_i(t)$.
		\item If $\beta$ is a rational canonical basis for $T$, then $\beta_i = \beta \cap K_{\phi_i}$ is a basis for $K_{\phi_i}$ for each $i$.
		\item If $\gamma_i$ is a basis for $K_{\phi_i}$ for each $i$, then $\gamma = \gamma_1 \cup \gamma_2 \cup \dots \cup \gamma_k$ is a basis for $V$. In particular, if each $\gamma_i$ is a disjoint union of $T$-cyclic bases, then $\gamma$ is a rational canonical basis for $T$.
	\end{enumerate}
\end{theorem}

\begin{definition}
	\hfill\\
	Let $\beta$ be a rational canonical basis for $T$, and $\beta_{v_1}, \beta_{v_2}, \dots, \beta_{v_k}$ be the $T$-cyclic bases of $\beta$ that are contained in $K_\phi$. Consider these $T$-cyclic bases $\beta_{v_i}$, and suppose again that the $T$-annihilator of $v_j$ is $(\phi(t))^{p_j}$. Then $\beta_{v_j}$ consists of $dp_j$ vectors in $\beta$, where $d$ is the degree of the polynomial. For $0 \leq i < d$, let $\gamma_i$ be the cycle of generalized eigenvectors of $U$ corresponding to $\lambda = 0$ with end vector $T^i(v_j)$, where $T^0(v_j) = b_j$. Then

	\[\gamma_i = \{(\phi(T))^{p_j-1}T^i(v_j), (\phi(T))^{p_j-2}T^i(v_j), \dots, (\phi(T))T^i(v_j),T^i(v_j)\}.\]

	By \autoref{Theorem 7.1}, $\gamma_i$ is a linearly independent subset of $\mathsf{C}_{v_i}$. Now let

	\[\alpha_j = \gamma_0 \cup \gamma_1 \cup \dots \cup \gamma_{d - 1}.\]

	Notice that $\alpha_j$ contains $p_jd$ vectors.
\end{definition}

\subsection*{Uniqueness of the Rational Canonical Form}
\addcontentsline{toc}{subsection}{Uniqueness of the Rational Canonical Form}

\begin{lemma}
	\hfill\\
	$\alpha_j$ is an ordered basis for $\mathsf{C}_{v_j}$.
\end{lemma}

\begin{lemma}
	\hfill\\
	$\alpha$ is a Jordan canonical basis for $K_\phi$.
\end{lemma}

\begin{theorem}
	\hfill\\
	Let $T$ be a linear operator on a finite-dimensional vector space $V$, let $\phi(t)$ be an irreducible monic divisor of the characteristic polynomial of $T$ of degree $d$, and let $r_i$ denote the number of dots in the $i$th row of the dot diagram for $\phi(t)$ with respect to a rational canonical basis for $T$. Then

	\begin{enumerate}
		\item $r_1 = \displaystyle\frac{1}{d}[\ldim{V}-\rank{\phi(T)}]$
		\item $r_i = \displaystyle\frac{1}{d}[\rank{(\phi(T))^{i-1}} - \rank{(\phi(t))^i}]$ for $i > 1$.
	\end{enumerate}
\end{theorem}

\begin{corollary}
	\hfill\\
	Under the conventions described earlier, the rational canonical form of a linear operator is unique up to the arrangement of the irreducible monic divisors of the characteristic polynomial.
\end{corollary}

\begin{definition}
	\hfill\\
	Since the rational canonical form of a linear operator is unique, the polynomials corresponding to the companion matrices that determine this form are also unique. These polynomials, which are powers of the irreducible monic divisors, are called the \textbf{elementary divisors} of the linear operator. Since a companion matrix may occur more than once in a rational canonical form, the same is true for the elementary divisors. We call the number of such occurrences the \textbf{multiplicity} of the elementary divisor.

	Conversely, the elementary divisors and their multiplicities determine the companion matrices and, therefore, the rational canonical form of a linear operator.
\end{definition}

\begin{definition}
	\hfill\\
	Let $A \in M_{n \times n}(\F)$. The \textbf{rational canonical form} of $A$ is defined to be the rational canonical form of $L_A$. Likewise, for $A$, the \textbf{elementary divisors} and their \textbf{multiplicities} are the same as those of $L_A$.
\end{definition}

\subsection*{Direct Sums}
\addcontentsline{toc}{subsection}{Direct Sums}

\begin{theorem}[\textbf{Primary Decomposition Theorem}]
	\hfill\\
	Let $T$ be a linear operator on an $n$-dimensional vector space $V$ with characteristic polynomial

	\[f(t) = (-1)^n(\phi_1(t))^{n_1} (\phi_2(t))^{n_2} \dots (\phi_k(t))^{n_k},\]

	where the $\phi_i(t)$'s ($1 \leq i \leq k$) are distinct irreducible monic polynomials and the $n_i$'s are positive integers. Then the following statements are true.

	\begin{enumerate}
		\item $V = K_{\phi_i} \oplus K_{\phi_2} \oplus \dots \oplus K_{\phi_k}$.
		\item If $T_i$ ($1 \leq i \leq k$) is the restriction of $T$ to $K_{\phi_i}$ and $C_i$ is the rational canonical form of $T_i$, then $C_1 \oplus C_2 \oplus \dots \oplus C_k$ is the rational canonical form of $T$.
	\end{enumerate}
\end{theorem}

\begin{theorem}
	\hfill\\
	Let$T$ be a linear operator on a finite-dimensional vector space $V$. Then $V$ is a direct sum of $T$-cyclic subspaces $\mathsf{C}_{v_i}$, where each $v_i$ lies in $K_\phi$ for some irreducible monic divisor $\phi(t)$ of the characteristic polynomial of $T$.
\end{theorem}
